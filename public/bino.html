<!DOCTYPE html>
<html lang="en">
<head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta http-equiv="content-type" content="text/html; charset=UTF-8">

    <title>i.Tel</title>
    <link rel='stylesheet' href='/stylesheets/style.css' />
        <!-- Required Stylesheets -->
    <link type="text/css" rel="stylesheet" href="https://unpkg.com/bootstrap/dist/css/bootstrap.min.css"/>
    <link type="text/css" rel="stylesheet" href="https://unpkg.com/bootstrap-vue@latest/dist/bootstrap-vue.css"/>

    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.4.1/css/all.css" integrity="sha384-5sAR7xN1Nv6T6+dT2mhtzEpVJvfS3NScPQTrOxhwjIuvcA67KV2R5Jz6kr4abQsz" crossorigin="anonymous">
    <!-- Required scripts -->
    <script src="https://unpkg.com/vue"></script>
    <script src="libs/moment.js"></script>

    <!-- script src="https://unpkg.com/bootstrap-vue@latest/dist/bootstrap-vue.js"></script -->
    <script src="libs/bootstrap-vue.js"></script>
    <script src="javascripts/cdr.js"></script>
    <script src="javascripts/nav.js"></script>
</head>

<body>
<!-- Our application root element -->
<div id="app">
    <div>
        <i-nav />
    </div>
    <i-cdr />
</div>

<!-- Start running your app -->
<script>
    window.JSON.ajax = function (url, method, data){
        return new Promise( (resolve, reject) => {
            fetch(url, {
                method: method,
                body: JSON.stringify(data),
                headers:{ 'Content-Type': 'application/json' }
            }).then(res => {
                res.json().then( data => {
                    if (res.status === 200) {
                        resolve(data)
                    } else {
                        reject(data)
                    }
                });
            })
        })
    };
    window.JSON.put = (url, data) => window.JSON.ajax(url, 'PUT', data);
    window.JSON.post = (url, data) => window.JSON.ajax(url, 'POST', data);

    window.global = {
        api: {
            bill: 'http://stat.fun.co.ua/fin.php'
        },
    };

    window.ws = new WebSocket(`ws://${window.location.host}`);

    window.bus = new Vue();
    window.bus.$on('CDR.add', _ => console.log(_));

    window.app = new Vue({
        el: "#app"
    })
</script>

</body>
</html>